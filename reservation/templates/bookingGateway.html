{% extends 'base.html' %}
{% load static %}
{% block base %}
<script src="../../static/js/currency.js"></script>
<div class="container-fluid height-700 bg-img bg-overlay"
    style="background-image: url(../../static/img/bg-img/meeting-1177454_1920.jpg);">
    <div class="row">
        <div class="col-md-12">

        </div>
    </div>
</div>
<section class="section-padding-100">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 card-wrapper">
                <div class="single-listing-content">
                    {% include 'alerts.html' %}
                    <div class="listing-title">
                        <h4>{{reservation.Service_Requred}} Booking <span class="brs">{{reservation.No_}}</span></h4>
                        <h6><span class="text-success">Status: </span>
                            {% if reservation.Booking_Status == 'Open' %}
                            Reserved
                            {% else %}
                            Booked
                            {% endif %}
                        </h6>
                    </div>
                    <div class="single-listing-nav">
                        <nav>
                            <ul id="listingNav">
                                <li class="active"><a href="#overview">Booking Overview</a></li>
                            </ul>
                        </nav>
                    </div>

                    <div class="overview-content mt-50" id="overview">
                        <div class="row">
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    <img src="../../static/img/icons/check-mark.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Type of Client: <span
                                            class="brs">{{reservation.Type_Of_Client}}</span></span>
                                </label>
                            </div>
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    <img src="../../static/img/icons/schedule.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Payment Due Date: <span
                                            class="brs">{{reservation.Payment_Due_Date}}</span></span>

                                </label>
                            </div>
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    <img src="../../static/img/icons/check-mark.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Type of Service: <span
                                            class="brs">{{reservation.Service_Requred}}</span></span>
                                </label>
                            </div>
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    {% if reservation.Booking_Status == 'Open' %}
                                    <img src="../../static/img/icons/booking.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Booking Status: <span
                                            class="brs">Reserved</span></span>
                                    {% else %}
                                    <img src="../../static/img/icons/calendar.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Booking Status: <span
                                            class="brs">Booked</span></span>
                                    {% endif %}
                                </label>
                            </div>
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    <img src="../../static/img/icons/schedule.png" height="20" width="20"
                                        class="img-fluid" alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Document Date: <span
                                            class="brs">{{reservation.Document_Date}}</span></span>

                                </label>
                            </div>
                            <div class="col-6">
                                <label class="custom-control custom-checkbox mb-3">
                                    {% if reservation.Service_Requred == 'Meeting Room' %}
                                    <img src="../../static/img/icons/money.png" height="20" width="20" class="img-fluid"
                                        alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Total Payable: <span
                                            class="brs Room_Booking_Total_Amount"></span></span>
                                    {% elif reservation.Service_Requred == 'Accommodation' %}
                                    <img src="../../static/img/icons/money.png" height="20" width="20" class="img-fluid"
                                        alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Total Payable: <span
                                            class="brsn Accomodation_Total_Amount"></span></span>
                                    {% else %}
                                    <img src="../../static/img/icons/money.png" height="20" width="20" class="img-fluid"
                                        alt="">
                                    <span class="custom-control-indicator"></span>
                                    <span class="custom-control-description">Total Payable: <span
                                            class="brs">Null</span></span>
                                    {% endif %}
                                </label>
                            </div>
                        </div>
                        <!-- Button trigger modal -->
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                            data-bs-target="#exampleModal">
                            Launch demo modal
                        </button>

                        <!-- Modal -->
                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                            aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        ...
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary"
                                            data-bs-dismiss="modal">Close</button>
                                        <button type="button" class="btn btn-primary">Save changes</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div id="accordion" class="accordion-style">
                                    <div class="card mb-3">
                                        <div class="card-header" id="headingOne">
                                            <h5 class="mb-0">
                                                <button class="btn btn-link collapsed" data-bs-toggle="collapse"
                                                    data-bs-target="#collapseOne" aria-expanded="false"
                                                    aria-controls="collapseOne">
                                                    Modify Booking Request
                                                </button>
                                            </h5>
                                        </div>
                                        <div id="collapseOne" class="collapse" aria-labelledby="headingOne"
                                            data-bs-parent="#accordion">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <form action="{% url 'BookingGateway' reservation.No_ %}"
                                                            method="post">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="myAction" value="modify">
                                                            <input type="hidden" name="bookingNo"
                                                                value="{{reservation.No_}}">
                                                            <div class="row gx-2 my-3">
                                                                <div class="col-md-6">
                                                                    <label for="" class="form-label">Client Type</label>
                                                                    <select class="form-select" name="clientType">
                                                                        <option selected disabled value="0">--Select
                                                                            Client Type--</option>
                                                                        <option value="1">Private</option>
                                                                        <option value="2">Public</option>
                                                                        <option value="3">Foreign</option>
                                                                    </select>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <label for="" class="form-label">Type of
                                                                        Service</label>
                                                                    <select class="form-select" name="typeOfService"
                                                                        id="typeOfService"
                                                                        aria-label="Default select example">
                                                                        <option selected disabled value="0">--Select
                                                                            Type of Service--</option>
                                                                        <option value="1">Meeting Room</option>
                                                                        <option value="2">Accommodation</option>
                                                                        <option value="3">Meeting Room and Accommodation
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <button class="btn button-87" type="submit">Modify</button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card mb-3">
                                        <div class="card-header" id="headingThree">
                                            <h5 class="mb-0">
                                                <button class="btn btn-link" data-bs-toggle="collapse"
                                                    data-bs-target="#collapseThree" aria-expanded="true"
                                                    aria-controls="collapseThree">Booking Details
                                                </button>
                                            </h5>
                                        </div>
                                        <div id="collapseThree" class="collapse show" aria-labelledby="headingThree"
                                            data-bs-parent="#accordion">
                                            <div class="card-body">
                                                <div class="row mt-4">
                                                    <div class="col-md-12">
                                                        <table id="example"
                                                            class="ui celled table responsive nowrap unstackable"
                                                            style="width:100%">
                                                            {% if reservation.Service_Requred == 'Meeting Room' %}
                                                            <thead>
                                                                <tr>
                                                                    <th>Type of Room</th>
                                                                    <th>Service Required</th>
                                                                    <th>No. of People</th>
                                                                    <th>Start Date</th>
                                                                    <th>Start Time</th>
                                                                    <th>End Date</th>
                                                                    <th>Room Charges</th>
                                                                    <th>Action</th>
                                                            </thead>
                                                            <tbody>
                                                                {% for meeting in meeting_room_lines %}
                                                                <tr>
                                                                    <td>{{meeting.Room}}</td>
                                                                    <td> {{meeting.ServiceRequired}}</td>
                                                                    <td>{{meeting.No_Of_Rooms}}</td>
                                                                    <td>{{meeting.Booking_Date}}</td>
                                                                    <td>{{meeting.Start_Time}}</td>
                                                                    <td>{{meeting.End_Time}}</td>
                                                                    <td id="roomAmount{{meeting.No}}">
                                                                        KES 00.00</td>
                                                                    <td>{{meeting.No_Of_Rooms}}</td>
                                                                </tr>
                                                                <script>
                                                                    $(document).ready(function () {
                                                                        $("#roomAmount{{meeting.No}}").empty()
                                                                            .append(currency(
                                                                                '{{meeting.Amount}}', {
                                                                                    separator: ','
                                                                                }).format());
                                                                    })
                                                                </script>
                                                                {% endfor %}
                                                            </tbody>
                                                            {% elif reservation.Service_Requred == 'Accommodation' %}
                                                            <thead>
                                                                <tr>
                                                                    <th>Type of Room</th>
                                                                    <th>Service Required</th>
                                                                    <th>No. of Rooms</th>
                                                                    <th>Start Date</th>
                                                                    <th>End Date</th>
                                                                    <th>Room Charges</th>
                                                                    <th>Action</th>
                                                            </thead>
                                                            <tbody>
                                                                {% for accomodation in accomodation_lines %}
                                                                <tr>
                                                                    <td>{{accomodation.Room}}</td>
                                                                    <td>{{accomodation.ServiceRequired}}</td>
                                                                    <td>{{accomodation.No_Of_Rooms}}</td>
                                                                    <td>{{accomodation.Start_Date}}</td>
                                                                    <td>{{accomodation.End_Date}}</td>
                                                                    <td id="accomoAmount{{accomodation.No}}">KES 00.00
                                                                    </td>
                                                                    <td>{{accomodation.No_Of_Rooms}}</td>
                                                                </tr>
                                                                <script>
                                                                    $(document).ready(function () {
                                                                        $("#accomoAmount{{accomodation.No}}")
                                                                            .empty()
                                                                            .append(currency(
                                                                                '{{accomodation.Amount}}', {
                                                                                    separator: ','
                                                                                }).format());
                                                                    })
                                                                </script>
                                                                {% endfor %}
                                                            </tbody>
                                                            {% endif %}
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 card-wrapper">
                <div class="opening-hours-widget mt-30">
                    <h6>Payments</h6>
                    <ul class="opening-hours">
                        <li>
                            <p>Total Amount</p>
                            <p class="text-dark">
                                {% if reservation.Service_Requred == 'Meeting Room' %}
                                <span class="Room_Booking_Total_Amount">KES ---.--</span></p>
                            {% elif reservation.Service_Requred == 'Accommodation' %}
                            <span class="Accomodation_Total_Amount">KES ---.--</span></p>
                            {% else %}
                            <span class="">KES ---.--</span></p>
                            {% endif %}
                        </li>
                    </ul>
                </div>
                <div class="book-a-table-widget mt-0">
                    <h6>Make Payment</h6>
                    <form action="" method="POST" class="mt-5">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-12">
                                <input type="text" class="form-control" placeholder="Enter Your Number">
                                <button type="submit" class="button-87  w-100 my-3">Pay KES 10,000.00</button>
                            </div>
                    </form>

                </div>
            </div>
            <a href="{% url 'reserve' %}" type="button" class="button-5  w-100 my-3">Go Back
                <i class="las la-undo-alt mx-2" style="font-size:1.5rem"></i></a>
        </div>
    </div>
    <!-- Modals -->
    <div class="modal fade" id="cancelModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-white">Cancel Process <i
                            class="las la-exclamation-circle text-danger"></i></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Do you want to cancel process? All your data will be <span class="text-danger">Deleted</span>!

                    <button type="button" class="btn button-0 my-3" data-bs-dismiss="modal"
                        style="display: inline-block">Discard <i class="las la-window-close mx-2"
                            style="font-size:1.5rem"></i></button>
                    <form action="{% url 'CancelReservation' %}" method="post" style="display: inline-block">

                        <button type="submit" class="btn btn-primary my-3 button-5">Confirm <i
                                class="las la-trash-alt mx-2" style="font-size:1.5rem"></i></button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
{% include 'footer.html' %}
<script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/dataTables.semanticui.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.9/js/responsive.semanticui.min.js"></script>
<script>
    $(document).ready(function () {
        $('#example').DataTable();
        $(".Room_Booking_Total_Amount").empty().append(currency(
            '{{reservation.Room_Booking_Total_Amount}}', {
                separator: ','
            }).format());
        $(".Accomodation_Total_Amount").empty().append(currency(
            '{{reservation.Accomodation_Total_Amount}}', {
                separator: ','
            }).format());
    });
</script>
{% endblock %}